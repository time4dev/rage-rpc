!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports=r():e.rpc=r()}("undefined"!=typeof self?self:this,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=1)}([function(module,__webpack_exports__,__webpack_require__){"use strict";var MpTypes;function isObjectMpType(e,r){const t="client"===getEnvironment();if(e&&"object"==typeof e&&void 0!==e.id){const n=(r,n,o)=>t?e.type===r&&n.at(e.id)===e:e instanceof o;switch(r){case MpTypes.Blip:return n("blip",mp.blips,mp.Blip);case MpTypes.Checkpoint:return n("checkpoint",mp.checkpoints,mp.Checkpoint);case MpTypes.Colshape:return n("colshape",mp.colshapes,mp.Colshape);case MpTypes.Label:return n("textlabel",mp.labels,mp.TextLabel);case MpTypes.Marker:return n("marker",mp.markers,mp.Marker);case MpTypes.Object:return n("object",mp.objects,mp.Object);case MpTypes.Pickup:return n("pickup",mp.pickups,mp.Pickup);case MpTypes.Player:return n("player",mp.players,mp.Player);case MpTypes.Vehicle:return n("vehicle",mp.vehicles,mp.Vehicle)}}return!1}function uid(){const e=46656*Math.random()|0,r=46656*Math.random()|0;return("000"+e.toString(36)).slice(-3)+("000"+r.toString(36)).slice(-3)}function getEnvironment(){return mp.joaat?"server":mp.game&&mp.game.joaat?"client":mp.trigger?"cef":void 0}function stringifyData(e){const r=getEnvironment();return JSON.stringify(e,(e,t)=>{if("client"===r||"server"===r&&t&&"object"==typeof t){let e;if(isObjectMpType(t,MpTypes.Blip)?e=MpTypes.Blip:isObjectMpType(t,MpTypes.Checkpoint)?e=MpTypes.Checkpoint:isObjectMpType(t,MpTypes.Colshape)?e=MpTypes.Colshape:isObjectMpType(t,MpTypes.Marker)?e=MpTypes.Marker:isObjectMpType(t,MpTypes.Object)?e=MpTypes.Object:isObjectMpType(t,MpTypes.Pickup)?e=MpTypes.Pickup:isObjectMpType(t,MpTypes.Player)?e=MpTypes.Player:isObjectMpType(t,MpTypes.Vehicle)&&(e=MpTypes.Vehicle),e)return{__t:e,i:"number"==typeof t.remoteId?t.remoteId:t.id};if(t instanceof Function||"function"==typeof t){let e=t.toString();return e.length<8||"function"!==e.substring(0,8)?"_NuFrRa_"+e:e}}return t})}function parseData(data){const env=getEnvironment();return JSON.parse(data,(_,value)=>{if(("client"===env||"server"===env)&&value&&"object"==typeof value&&"string"==typeof value.__t&&"number"==typeof value.i&&2===Object.keys(value).length){const id=value.i,type=value.__t;let collection;switch(type){case MpTypes.Blip:collection=mp.blips;break;case MpTypes.Checkpoint:collection=mp.checkpoints;break;case MpTypes.Colshape:collection=mp.colshapes;break;case MpTypes.Label:collection=mp.labels;break;case MpTypes.Marker:collection=mp.markers;break;case MpTypes.Object:collection=mp.objects;break;case MpTypes.Pickup:collection=mp.pickups;break;case MpTypes.Player:collection=mp.players;break;case MpTypes.Vehicle:collection=mp.vehicles}if(collection)return collection["client"===env?"atRemoteId":"at"](id);{if(value.length<8)return value;let prefix=value.substring(0,8);if("function"===prefix)return eval("("+value+")");if("_NuFrRa_"===prefix)return eval(value.slice(8))}}return value})}function promiseResolve(e){return new Promise(r=>setTimeout(()=>r(e),0))}function promiseReject(e){return new Promise((r,t)=>setTimeout(()=>t(e),0))}function promiseTimeout(e,r){return"number"==typeof r?Promise.race([new Promise((e,t)=>{setTimeout(()=>t("TIMEOUT"),r)}),e]):e}function isBrowserValid(e){try{e.url}catch(e){return!1}return!0}__webpack_require__.d(__webpack_exports__,"h",(function(){return uid})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getEnvironment})),__webpack_require__.d(__webpack_exports__,"g",(function(){return stringifyData})),__webpack_require__.d(__webpack_exports__,"c",(function(){return parseData})),__webpack_require__.d(__webpack_exports__,"e",(function(){return promiseResolve})),__webpack_require__.d(__webpack_exports__,"d",(function(){return promiseReject})),__webpack_require__.d(__webpack_exports__,"f",(function(){return promiseTimeout})),__webpack_require__.d(__webpack_exports__,"b",(function(){return isBrowserValid})),function(e){e.Blip="b",e.Checkpoint="cp",e.Colshape="c",e.Label="l",e.Marker="m",e.Object="o",e.Pickup="p",e.Player="pl",e.Vehicle="v"}(MpTypes||(MpTypes={}))},function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"register",(function(){return a})),t.d(r,"unregister",(function(){return l})),t.d(r,"call",(function(){return u})),t.d(r,"callServer",(function(){return f})),t.d(r,"callClient",(function(){return m})),t.d(r,"callBrowsers",(function(){return h})),t.d(r,"callBrowser",(function(){return v})),t.d(r,"on",(function(){return y})),t.d(r,"off",(function(){return k})),t.d(r,"trigger",(function(){return T})),t.d(r,"triggerClient",(function(){return M})),t.d(r,"triggerServer",(function(){return x})),t.d(r,"triggerBrowsers",(function(){return O})),t.d(r,"triggerBrowser",(function(){return R}));var n=t(0);const o=n.a();if(!o)throw"Unknown RAGE environment";const s="__rpc:triggerEvent",c="cef"===o?window:e;if(!c["__rpc:process"]){if(c.__rpcListeners={},c.__rpcPending={},c.__rpcEvListeners={},c["__rpc:process"]=(e,r)=>{"server"!==o&&(r=e);const t=n.c(r);if(t.req){const r={id:t.id,environment:t.fenv||t.env};"server"===o&&(r.player=e);const s={ret:1,id:t.id,env:o};let a;switch(o){case"server":a=e=>r.player.call("__rpc:process",[n.g(e)]);break;case"client":if("server"===t.env)a=e=>mp.events.callRemote("__rpc:process",n.g(e));else if("cef"===t.env){const e=t.b&&c.__rpcBrowsers[t.b];r.browser=e,a=r=>e&&n.b(e)&&i(e,r,!0)}break;case"cef":a=e=>mp.trigger("__rpc:process",n.g(e))}if(a){const e=p(t.name,t.args,r);t.noRet||e.then(e=>a({...s,res:e})).catch(e=>a({...s,err:e||null}))}}else if(t.ret){const r=c.__rpcPending[t.id];if("server"===o&&r.player!==e)return;r&&(r.resolve(t.hasOwnProperty("err")?n.d(t.err):n.e(t.res)),delete c.__rpcPending[t.id])}},"cef"!==o){if(mp.events.add("__rpc:process",c["__rpc:process"]),"client"===o){a("__rpc:callServer",([e,r,t],n)=>_(e,r,{fenv:n.environment,noRet:t})),a("__rpc:callBrowsers",([e,r,t],n)=>w(null,e,r,{fenv:n.environment,noRet:t})),c.__rpcBrowsers={};const e=e=>{const r=n.h();Object.keys(c.__rpcBrowsers).forEach(r=>{const t=c.__rpcBrowsers[r];t&&n.b(t)&&t!==e||delete c.__rpcBrowsers[r]}),c.__rpcBrowsers[r]=e,e.execute(`\n                    window.name = '${r}';\n                    if(typeof window['__rpc:id'] === 'undefined'){\n                        window['__rpc:id'] = Promise.resolve(window.name);\n                    }else{\n                        window['__rpc:id:resolve'](window.name);\n                    }\n                `)};mp.browsers.forEach(e),mp.events.add("browserCreated",e),c.__rpcBrowserProcedures={},mp.events.add("__rpc:browserRegister",e=>{const[r,t]=JSON.parse(e);c.__rpcBrowserProcedures[t]=r}),mp.events.add("__rpc:browserUnregister",e=>{const[r,t]=JSON.parse(e);c.__rpcBrowserProcedures[t]===r&&delete c.__rpcBrowserProcedures[t]}),a("__rpc:triggerEventBrowsers",([e,r],t)=>{Object.values(c.__rpcBrowsers).forEach(n=>{d(n,s,[e,r],{fenv:t.environment,noRet:1})})})}}else void 0===c["__rpc:id"]&&(c["__rpc:id"]=new Promise(e=>{window.name?e(window.name):c["__rpc:id:resolve"]=e}));a(s,([e,r],t)=>b(e,r,t))}function i(e,r,t){const o=n.g(r);e.execute(`var process = window["__rpc:process"]; if(process){ process(${JSON.stringify(o)}); }else{ ${t?"":`mp.trigger("__rpc:process", '{"ret":1,"id":"${r.id}","err":"PROCEDURE_NOT_FOUND","env":"cef"}');`} }`)}function p(e,r,t){const o=c.__rpcListeners[e];return o?n.e(o(r,t)):n.d("PROCEDURE_NOT_FOUND")}function a(e,r){if(2!==arguments.length)throw'register expects 2 arguments: "name" and "cb"';return"cef"===o&&c["__rpc:id"].then(r=>mp.trigger("__rpc:browserRegister",JSON.stringify([r,e]))),c.__rpcListeners[e]=r,()=>l(e)}function l(e){if(1!==arguments.length)throw'unregister expects 1 argument: "name"';"cef"===o&&c["__rpc:id"].then(r=>mp.trigger("__rpc:browserUnregister",JSON.stringify([r,e]))),c.__rpcListeners[e]=void 0}function u(e,r,t={}){return arguments.length<1||arguments.length>3?n.d('call expects 1 to 3 arguments: "name", optional "args", and optional "options"'):n.f(p(e,r,{environment:o}),t.timeout)}function _(e,r,t={}){switch(o){case"server":return u(e,r);case"client":{const s=n.h();return new Promise(i=>{t.noRet||(c.__rpcPending[s]={resolve:i});const p={req:1,id:s,name:e,env:o,args:r,...t};mp.events.callRemote("__rpc:process",n.g(p))})}case"cef":return m("__rpc:callServer",[e,r,+t.noRet])}}function f(e,r,t={}){if(arguments.length<1||arguments.length>3)return n.d('callServer expects 1 to 3 arguments: "name", optional "args", and optional "options"');let o={};return t.noRet&&(o.noRet=1),n.f(_(e,r,o),t.timeout)}function g(e,r,t,s={}){switch(o){case"client":return u(r,t);case"server":{const i=n.h();return new Promise(p=>{s.noRet||(c.__rpcPending[i]={resolve:p,player:e});const a={req:1,id:i,name:r,env:o,args:t,...s};e.call("__rpc:process",[n.g(a)])})}case"cef":{const e=n.h();return c["__rpc:id"].then(i=>new Promise(p=>{s.noRet||(c.__rpcPending[e]={resolve:p});const a={b:i,req:1,id:e,name:r,env:o,args:t,...s};mp.trigger("__rpc:process",n.g(a))}))}}}function m(e,r,t,s={}){switch(o){case"client":if(s=t||{},t=r,r=e,e=null,arguments.length<1||arguments.length>3||"string"!=typeof r)return n.d('callClient from the client expects 1 to 3 arguments: "name", optional "args", and optional "options"');break;case"server":if(arguments.length<2||arguments.length>4||"object"!=typeof e)return n.d('callClient from the server expects 2 to 4 arguments: "player", "name", optional "args", and optional "options"');break;case"cef":if(s=t||{},t=r,r=e,e=null,arguments.length<1||arguments.length>3||"string"!=typeof r)return n.d('callClient from the browser expects 1 to 3 arguments: "name", optional "args", and optional "options"')}let c={};return s.noRet&&(c.noRet=1),n.f(g(e,r,t,c),s.timeout)}function d(e,r,t,s={}){return new Promise(p=>{const a=n.h();s.noRet||(c.__rpcPending[a]={resolve:p}),i(e,{req:1,id:a,name:r,env:o,args:t,...s},!1)})}function w(e,r,t,s={}){switch(o){case"client":const o=c.__rpcBrowserProcedures[r];if(!o)return n.d("PROCEDURE_NOT_FOUND");const i=c.__rpcBrowsers[o];return i&&n.b(i)?d(i,r,t,s):n.d("PROCEDURE_NOT_FOUND");case"server":return g(e,"__rpc:callBrowsers",[r,t,+s.noRet],s);case"cef":return g(null,"__rpc:callBrowsers",[r,t,+s.noRet],s)}}function h(e,r,t,s={}){let c,i={};switch(o){case"client":case"cef":if(s=t||{},t=r,r=e,arguments.length<1||arguments.length>3)return n.d('callBrowsers from the client or browser expects 1 to 3 arguments: "name", optional "args", and optional "options"');s.noRet&&(i.noRet=1),c=w(null,r,t,i);break;case"server":if(arguments.length<2||arguments.length>4)return n.d('callBrowsers from the server expects 2 to 4 arguments: "player", "name", optional "args", and optional "options"');s.noRet&&(i.noRet=1),c=w(e,r,t,i)}if(c)return n.f(c,s.timeout)}function v(e,r,t,s={}){if("client"!==o)return n.d("callBrowser can only be used in the client environment");if(arguments.length<2||arguments.length>4)return n.d('callBrowser expects 2 to 4 arguments: "browser", "name", optional "args", and optional "options"');let c={};return s.noRet&&(c.noRet=1),n.f(d(e,r,t,c),s.timeout)}function b(e,r,t){const n=c.__rpcEvListeners[e];n&&n.forEach(e=>e(r,t))}function y(e,r){if(2!==arguments.length)throw'on expects 2 arguments: "name" and "cb"';const t=c.__rpcEvListeners[e]||new Set;return t.add(r),c.__rpcEvListeners[e]=t,()=>k(e,r)}function k(e,r){if(2!==arguments.length)throw'off expects 2 arguments: "name" and "cb"';const t=c.__rpcEvListeners[e];t&&t.delete(r)}function T(e,r){if(arguments.length<1||arguments.length>2)throw'trigger expects 1 or 2 arguments: "name", and optional "args"';b(e,r,{environment:o})}function M(e,r,t){switch(o){case"client":if(t=r,r=e,e=null,arguments.length<1||arguments.length>2||"string"!=typeof r)throw'triggerClient from the client expects 1 or 2 arguments: "name", and optional "args"';break;case"server":if(arguments.length<2||arguments.length>3||"object"!=typeof e)throw'triggerClient from the server expects 2 or 3 arguments: "player", "name", and optional "args"';break;case"cef":if(t=r,r=e,e=null,arguments.length<1||arguments.length>2||"string"!=typeof r)throw'triggerClient from the browser expects 1 or 2 arguments: "name", and optional "args"'}g(e,s,[r,t],{noRet:1})}function x(e,r){if(arguments.length<1||arguments.length>2)throw'triggerServer expects 1 or 2 arguments: "name", and optional "args"';_(s,[e,r],{noRet:1})}function O(e,r,t){switch(o){case"client":case"cef":if(t=r,r=e,e=null,arguments.length<1||arguments.length>2)throw'triggerBrowsers from the client or browser expects 1 or 2 arguments: "name", and optional "args"';break;case"server":if(arguments.length<2||arguments.length>3)throw'triggerBrowsers from the server expects 2 or 3 arguments: "player", "name", and optional "args"'}g(e,"__rpc:triggerEventBrowsers",[r,t],{noRet:1})}function R(e,r,t){if("client"!==o)throw"callBrowser can only be used in the client environment";if(arguments.length<2||arguments.length>4)throw'callBrowser expects 2 or 3 arguments: "browser", "name", and optional "args"';d(e,s,[r,t],{noRet:1})}r.default={register:a,unregister:l,call:u,callServer:f,callClient:m,callBrowsers:h,callBrowser:v,on:y,off:k,trigger:T,triggerServer:x,triggerClient:M,triggerBrowsers:O,triggerBrowser:R}}.call(this,t(2))},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t}])}));